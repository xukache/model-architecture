<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="探索Transformer架构原理的可视化平台 - 深入了解现代大语言模型的基础">
    <meta name="keywords" content="Transformer, 注意力机制, 大语言模型, 自然语言处理, NLP, 架构">
    <meta name="author" content="AI 架构可视化团队">
    <meta name="theme-color" content="#8b5cf6"> 
    <title>Transformer架构 - 大模型全栈平台</title>

    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 全局配置脚本 -->
    <script src="../../common/js/config.js"></script>
    
    <!-- Preline UI -->
    <link rel="stylesheet" href="../../common/styles/variants.min.css" />
    
    <!-- 编译后的 CSS -->
    <link rel="stylesheet" href="../../common/styles/output.css">

    <!-- 数据流转交互动画示意图 -->
    <link rel="stylesheet" href="../../common/css/models/transformer/transformer_animate.css">

    <!-- 图标库 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body class="bg-neutral-50 dark:bg-neutral-900 text-neutral-800 dark:text-neutral-200 transition-colors duration-300">
    <!-- 页面顶部导航 -->
    <header class="sticky top-0 z-50 bg-neutral-50/80 dark:bg-neutral-900/80 glassmorphism border-b border-light">
        <div class="container mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center">
                <a href="../../index.html" class="flex items-center">
                    <div class="w-8 h-8 bg-gradient-primary rounded-lg flex items-center justify-center mr-3">
                        <i class="fas fa-brain text-white text-lg"></i>
                    </div>
                    <h1 class="text-lg font-medium text-neutral-800 dark:text-neutral-100">
                        大模型全栈平台
                    </h1>
                </a>
            </div>

            <nav class="hidden md:flex items-center space-x-1">
                <a href="../../index.html" class="nav-link">
                    首页
                </a>
                <a href="../theory/index.html" class="nav-link-active">
                    大模型原理
                </a>
                <a href="../../applications/index.html" class="nav-link">
                    应用开发
                </a>
                <a href="../../index.html#components" class="nav-link">
                    核心组件
                </a>
                <a href="../../index.html#about" class="nav-link">
                    关于
                </a>
            </nav>

            <div class="flex items-center space-x-3">
                <a href="https://github.com/xukache" target="_blank" 
                   class="text-neutral-700 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-neutral-200">
                    <i class="fab fa-github text-lg"></i>
                </a>
                <button id="theme-toggle" 
                    class="p-2 rounded-md text-neutral-700 dark:text-neutral-400 hover:bg-neutral-100 dark:hover:bg-neutral-800 hover:text-neutral-900 dark:hover:text-neutral-200">
                    <i class="fas fa-moon text-lg dark:hidden"></i>
                    <i class="fas fa-sun text-lg hidden dark:block"></i>
                </button>
                <button
                    class="md:hidden p-2 rounded-md text-neutral-700 dark:text-neutral-400 hover:bg-neutral-100 dark:hover:bg-neutral-800"
                    id="mobile-menu-button">
                    <i class="fas fa-bars text-lg"></i>
                </button>
            </div>
        </div>

        <!-- 移动端菜单 -->
        <div id="mobile-menu" class="md:hidden hidden bg-neutral-50 dark:bg-neutral-900 border-t border-light">
            <div class="container mx-auto px-4 py-3 space-y-2">
                <a href="../../index.html"
                    class="block px-3 py-2 rounded-md text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 hover:text-neutral-900 dark:hover:text-neutral-100 text-sm font-medium">
                    首页
                </a>
                <a href="../theory/index.html"
                    class="block px-3 py-2 rounded-md text-primary-600 dark:text-primary-400 bg-primary-50 dark:bg-primary-900/20 text-sm font-medium">
                    大模型原理
                </a>
                <a href="../../applications/index.html"
                    class="block px-3 py-2 rounded-md text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 hover:text-neutral-900 dark:hover:text-neutral-100 text-sm font-medium">
                    应用开发
                </a>
                <a href="../../index.html#components"
                    class="block px-3 py-2 rounded-md text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 hover:text-neutral-900 dark:hover:text-neutral-100 text-sm font-medium">
                    核心组件
                </a>
                <a href="../../index.html#about"
                    class="block px-3 py-2 rounded-md text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 hover:text-neutral-900 dark:hover:text-neutral-100 text-sm font-medium">
                    关于
                </a>
                <div class="border-t border-light my-3"></div>
                <a href="https://github.com/xukache" target="_blank"
                    class="block px-3 py-2 rounded-md text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 hover:text-neutral-900 dark:hover:text-neutral-100 text-sm font-medium">
                    <i class="fab fa-github mr-2"></i> GitHub
                </a>
                <button id="mobile-theme-toggle"
                    class="w-full text-left px-3 py-2 rounded-md text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-800 hover:text-neutral-900 dark:hover:text-neutral-100 text-sm font-medium">
                    <i class="fas fa-moon mr-2 dark:hidden"></i>
                    <i class="fas fa-sun mr-2 hidden dark:block"></i>
                    <span class="dark:hidden">切换到深色模式</span>
                    <span class="hidden dark:block">切换到浅色模式</span>
                </button>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-10 max-w-6xl">
        <!-- 模型介绍 -->
        <section class="py-10 animate-fade-in">
            <div class="flex items-center mb-6">
                <div
                    class="w-12 h-12 bg-purple-100 dark:bg-purple-900/50 rounded-full flex items-center justify-center mr-4">
                    <i class="fas fa-cubes text-xl text-purple-600 dark:text-purple-400"></i>
                </div>
                <h1 class="text-3xl md:text-4xl font-bold text-neutral-800 dark:text-neutral-100">
                    Transformer模型架构
                </h1>
            </div>

            <p class="text-neutral-600 dark:text-neutral-300 mb-6 text-lg max-w-3xl">
                Transformer是2017年由Google团队在论文《Attention Is All You
                Need》中提出的一种完全基于注意力机制的神经网络架构，成为现代大型语言模型的基础。它通过自注意力机制捕获序列数据中的长距离依赖关系，实现了卓越的并行计算能力。
            </p>

            <!-- 关键特性 -->
            <div class="flex flex-wrap gap-3 mb-8">
                <span
                    class="px-3 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-100 rounded-full">
                    <i class="fas fa-brain mr-1"></i>自注意力机制
                </span>
                <span
                    class="px-3 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-100 rounded-full">
                    <i class="fas fa-code-branch mr-1"></i>多头注意力
                </span>
                <span
                    class="px-3 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-100 rounded-full">
                    <i class="fas fa-wave-square mr-1"></i>位置编码
                </span>
                <span
                    class="px-3 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-100 rounded-full">
                    <i class="fas fa-network-wired mr-1"></i>前馈神经网络
                </span>
                <span
                    class="px-3 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-100 rounded-full">
                    <i class="fas fa-plus-circle mr-1"></i>残差连接
                </span>
            </div>
        </section>

        <!-- 目录导航区域 -->
        <section id="components"
            class="my-8 bg-white dark:bg-neutral-800 rounded-xl shadow-sm border border-neutral-100 dark:border-neutral-700 p-6">
            <h2 class="text-xl font-semibold text-neutral-800 dark:text-neutral-100 mb-4">
                <i class="fas fa-puzzle-piece text-purple-500 mr-2"></i>Transformer 模型组件
            </h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- 目录项 - 自注意力机制 -->
                <a href="#attention"
                    class="p-3 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors flex items-center">
                    <div
                        class="w-8 h-8 bg-purple-100 dark:bg-purple-900/50 rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-brain text-purple-600 dark:text-purple-400 text-sm"></i>
                    </div>
                    <div>
                        <h3 class="text-sm font-medium text-neutral-800 dark:text-neutral-200">自注意力机制</h3>
                        <p class="text-xs text-neutral-500 dark:text-neutral-400">Transformer核心创新，灵活建模序列关系</p>
                    </div>
                </a>
                
                <!-- 目录项 - 多头注意力 -->
                <a href="#multi-head-attention"
                    class="p-3 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors flex items-center">
                    <div
                        class="w-8 h-8 bg-purple-100 dark:bg-purple-900/50 rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-code-branch text-purple-600 dark:text-purple-400 text-sm"></i>
                    </div>
                    <div>
                        <h3 class="text-sm font-medium text-neutral-800 dark:text-neutral-200">多头注意力</h3>
                        <p class="text-xs text-neutral-500 dark:text-neutral-400">并行处理多个注意力，捕获不同特征</p>
                    </div>
                </a>
                
                <!-- 目录项 - 位置编码 -->
                <a href="#position-encoding"
                    class="p-3 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors flex items-center">
                    <div
                        class="w-8 h-8 bg-purple-100 dark:bg-purple-900/50 rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-wave-square text-purple-600 dark:text-purple-400 text-sm"></i>
                    </div>
                    <div>
                        <h3 class="text-sm font-medium text-neutral-800 dark:text-neutral-200">位置编码</h3>
                        <p class="text-xs text-neutral-500 dark:text-neutral-400">为序列元素提供位置信息</p>
                    </div>
                </a>
                
                <!-- 目录项 - 前馈神经网络 -->
                <a href="#feed-forward"
                    class="p-3 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors flex items-center">
                    <div
                        class="w-8 h-8 bg-purple-100 dark:bg-purple-900/50 rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-network-wired text-purple-600 dark:text-purple-400 text-sm"></i>
                    </div>
                    <div>
                        <h3 class="text-sm font-medium text-neutral-800 dark:text-neutral-200">前馈神经网络</h3>
                        <p class="text-xs text-neutral-500 dark:text-neutral-400">增强模型非线性表达能力</p>
                    </div>
                </a>
                
                <!-- 目录项 - 层归一化 -->
                <a href="#layer-norm"
                    class="p-3 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors flex items-center">
                    <div
                        class="w-8 h-8 bg-purple-100 dark:bg-purple-900/50 rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-balance-scale text-purple-600 dark:text-purple-400 text-sm"></i>
                    </div>
                    <div>
                        <h3 class="text-sm font-medium text-neutral-800 dark:text-neutral-200">层归一化</h3>
                        <p class="text-xs text-neutral-500 dark:text-neutral-400">稳定网络训练，加速收敛</p>
                    </div>
                </a>
                
                <!-- 目录项 - 残差连接 -->
                <a href="#residual"
                    class="p-3 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-700 transition-colors flex items-center">
                    <div
                        class="w-8 h-8 bg-purple-100 dark:bg-purple-900/50 rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-plus-circle text-purple-600 dark:text-purple-400 text-sm"></i>
                    </div>
                    <div>
                        <h3 class="text-sm font-medium text-neutral-800 dark:text-neutral-200">残差连接</h3>
                        <p class="text-xs text-neutral-500 dark:text-neutral-400">缓解梯度消失，传递信息到深层</p>
                    </div>
                </a>
            </div>
        </section>
        
        <!-- 模型架构图 -->
        <section id="architecture-section" class="my-12">
            <h2 class="text-2xl font-bold text-neutral-800 dark:text-neutral-100 mb-6">
                <i class="fas fa-sitemap text-purple-500 mr-2"></i>Transformer架构概览
            </h2>

            <!-- 可视化的模型架构图 -->
            <div
                class="bg-white dark:bg-neutral-800 rounded-xl shadow-sm border border-neutral-100 dark:border-neutral-700 p-6">
                <div class="flex justify-center mb-6">
                    <svg viewBox="0 0 700 750" class="w-full max-w-4xl">
                        <!-- 背景 -->
                        <rect x="0" y="0" width="700" height="750" rx="10" fill="url(#transformer-grad)"
                            opacity="0.05" />
                        
                        <!-- 输出模块（绿色边框） -->
                        <rect x="350" y="20" width="300" height="130" rx="5" stroke="#2e8b57" stroke-width="3"
                            fill="white" class="dark:white" />
                        <text x="555" y="40" text-anchor="start" fill="#2e8b57" class="dark:fill-green-400"
                            font-size="18" font-weight="bold">4. Output</text>
                        <text x="470" y="40" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="14">Output Probabilities</text>
                        
                        <!-- Softmax -->
                        <rect x="375" y="65" width="190" height="25" rx="3" stroke="#555" stroke-width="1"
                            fill="#D0E4CB" class="dark:#D0E4CB" />
                        <text x="472" y="83" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Softmax</text>

                        <!-- Linear -->
                        <rect x="375" y="110" width="190" height="25" rx="3" stroke="#555" stroke-width="1"
                            fill="#f0f0f0" class="dark:#f0f0f0" />
                        <text x="472" y="126" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Linear</text>
                        
                        <!-- 解码器模块（蓝色边框） -->
                        <rect x="350" y="175" width="300" height="365" rx="5" stroke="#4682b4" stroke-width="3"
                            fill="white" class="dark:white" />
                        <text x="485" y="195" text-anchor="start" fill="#4682b4" class="dark:fill-blue-400"
                            font-size="18" font-weight="bold">3、Decoder block</text>
                        <text x="675" y="380" text-anchor="middle" fill="#4682b4" class="dark:fill-blue-400"
                            font-size="18">Nx</text>
                        
                        <!-- 解码器内部边框 -->
                        <rect x="365" y="210" width="240" height="325" rx="5" stroke="#555" stroke-width="1.5"
                            fill="#F3F3F3" />
                        
                        <!-- 解码器内部组件 -->
                        <!-- Add & Norm 1 -->
                        <rect x="380" y="220" width="190" height="30" rx="3" stroke="#555" stroke-width="1"
                            fill="#ffffcc" class="dark:#ffffcc" />
                        <text x="475" y="240" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Add & Norm</text>
                        
                        <!-- Feed Forward -->
                        <rect x="380" y="260" width="190" height="25" rx="3" stroke="#555" stroke-width="1"
                            fill="#add8e6" class="dark:#add8e6" />
                        <text x="475" y="278" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Feed Forward</text>
                        
                        <!-- Add & Norm 2 -->
                        <rect x="380" y="310" width="190" height="30" rx="3" stroke="#555" stroke-width="1"
                            fill="#ffffcc" class="dark:#ffffcc" />
                        <text x="475" y="330" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Add & Norm</text>
                        
                        <!-- Multi-Head Attention -->
                        <rect x="380" y="350" width="190" height="30" rx="3" stroke="#555" stroke-width="1"
                            fill="#ffcc99" class="dark:#ffcc99" />
                        <text x="475" y="370" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Multi-Head Attention</text>
                        
                        <!-- Add & Norm 3 -->
                        <rect x="380" y="415" width="190" height="30" rx="3" stroke="#555" stroke-width="1"
                            fill="#ffffcc" class="dark:#ffffcc" />
                        <text x="475" y="435" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Add & Norm</text>
                        
                        <!-- Masked Multi-Head Attention -->
                        <rect x="380" y="455" width="190" height="40" rx="3" stroke="#555" stroke-width="1"
                            fill="#ffcc99" class="dark:#ffcc99" />
                        <text x="475" y="475" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Masked Multi-Head</text>
                        <text x="475" y="490" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Attention</text>
                        
                        <!-- 编码器模块（红色边框） -->
                        <rect x="85" y="260" width="240" height="280" rx="5" stroke="#cd5c5c" stroke-width="3"
                            fill="white" class="dark:white" />
                        <text x="142" y="290" text-anchor="start" fill="#cd5c5c" class="dark:fill-red-400"
                            font-size="18" font-weight="bold">2、Encoder block</text>
                        <text x="60" y="410" text-anchor="middle" fill="#cd5c5c" class="dark:fill-red-400"
                            font-size="18">Nx</text>
                        
                        <!-- 编码器内部边框 -->
                        <rect x="100" y="310" width="210" height="225" rx="5" stroke="#555" stroke-width="1.5"
                            fill="#F3F3F3" />

                        <!-- 编码器内部组件 -->
                        <!-- Add & Norm 1 -->
                        <rect x="130" y="320" width="170" height="30" rx="3" stroke="#555" stroke-width="1"
                            fill="#ffffcc" class="dark:#ffffcc" />
                        <text x="215" y="340" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Add & Norm</text>
                        
                        <!-- Feed Forward -->
                        <rect x="130" y="360" width="170" height="25" rx="3" stroke="#555" stroke-width="1"
                            fill="#add8e6" class="dark:#add8e6" />
                        <text x="215" y="377" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Feed Forward</text>
                        
                        <!-- Add & Norm 2 -->
                        <rect x="130" y="415" width="170" height="30" rx="3" stroke="#555" stroke-width="1"
                            fill="#ffffcc" class="dark:#ffffcc" />
                        <text x="215" y="435" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Add & Norm</text>
                        
                        <!-- Multi-Head Attention -->
                        <rect x="130" y="455" width="170" height="40" rx="3" stroke="#555" stroke-width="1"
                            fill="#ffcc99" class="dark:#ffcc99" />
                        <text x="215" y="472" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Multi-Head</text>
                        <text x="215" y="487" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Attention</text>
                        
                        <!-- 输入模块（紫色边框） -->
                        <rect x="85" y="550" width="520" height="160" rx="5" stroke="#8b5cf6" stroke-width="3"
                            fill="white" class="dark:white" />
                        <text x="110" y="670" text-anchor="start" fill="#8b5cf6" class="dark:fill-purple-400"
                            font-size="18" font-weight="bold">1、input</text>
                        
                        <!-- 位置编码 - 左侧 -->
                        <text x="100" y="565" text-anchor="start" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Positional</text>
                        <text x="100" y="580" text-anchor="start" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Encoding</text>
                        
                        <!-- 位置编码 - 右侧 -->
                        <text x="540" y="565" text-anchor="start" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Positional</text>
                        <text x="540" y="580" text-anchor="start" fill="#1e293b" class="dark:fill-black"
                            font-size="12">Encoding</text>
                        
                        <!-- 左侧旋转图标和连接 -->
                        <circle cx="180" cy="570" r="15" stroke="#555" stroke-width="1.5" fill="none" />
                        <path d="M165,572 Q170,560 179,567 Q186,580 195,570" stroke="#555" stroke-width="1"
                            fill="none" />
                        <!-- 连接线到圆圈 -->
                        <line x1="195" y1="570" x2="217" y2="570" stroke="#555" stroke-width="1.5" />

                        <!-- 左侧残差连接 -->
                        <circle cx="217" cy="570" r="8" stroke="#64748b" stroke-width="1.5" fill="white"
                            class="dark:#64748b" />
                        <text x="217" y="576" text-anchor="middle" fill="#64748b" font-size="20">+</text>
                        
                        <!-- 右侧旋转图标和连接 -->
                        <circle cx="520" cy="570" r="15" stroke="#555" stroke-width="1.5" fill="none" />
                        <path d="M505,570 Q513,560 520,570 Q527,580 535,570" stroke="#555" stroke-width="1.5"
                            fill="none" />
                        <!-- 连接线到圆圈 -->
                        <line x1="484" y1="570" x2="506" y2="570" stroke="#555" stroke-width="1.5" />
                        
                        <!-- 右侧残差连接 -->
                        <circle cx="475" cy="570" r="8" stroke="#64748b" stroke-width="1.5" fill="white"
                            class="dark:#64748b" />
                        <text x="475" y="576" text-anchor="middle" fill="#64748b" font-size="20">+</text>
                        
                        <!-- 输入嵌入 -->
                        <rect x="160" y="605" width="115" height="30" rx="3" stroke="#555" stroke-width="1"
                            fill="#ffb6c1" class="dark:#ffb6c1" />
                        <text x="217" y="625" text-anchor="middle" fill="#1e293b" class="dark:#1e293b"
                            font-size="12">Input Embedding</text>
                        
                        <!-- 从Input Embedding到圆圈的连接线 -->
                        <line x1="217" y1="605" x2="217" y2="578" stroke="#555" stroke-width="1.5" />
                        <polygon points="217,578 212,588 222,588" fill="#555" />

                        <!-- 输出嵌入 -->
                        <rect x="420" y="605" width="115" height="30" rx="3" stroke="#555" stroke-width="1"
                            fill="#ffb6c1" class="dark:#ffb6c1" />
                        <text x="478" y="625" text-anchor="middle" fill="#1e293b" class="dark:#1e293b"
                            font-size="12">Output Embedding</text>
                        
                        <!-- 从Output Embedding到圆圈的连接线 -->
                        <line x1="475" y1="605" x2="475" y2="578" stroke="#555" stroke-width="1.5" />
                        <polygon points="475,578 470,588 480,588" fill="#555" />

                        <!-- 输入与输出文本 -->
                        <text x="217" y="690" text-anchor="middle" fill="#1e293b" class="dark:fill-white"
                            font-size="12">Inputs</text>
                        <text x="475" y="690" text-anchor="middle" fill="#1e293b" class="dark:fill-white"
                            font-size="12">Outputs (shifted right)</text>
                        
                        <!-- 输入箭头 -->
                        <line x1="217" y1="675" x2="217" y2="635" stroke="#555" stroke-width="1.5" />
                        <polygon points="217,635 212,645 222,645" fill="#555" />
                        
                        <!-- 输出箭头 -->
                        <line x1="475" y1="675" x2="475" y2="635" stroke="#555" stroke-width="1.5" />
                        <polygon points="475,635 470,645 480,645" fill="#555" />
                        
                        <!-- 连接线 -->
                        <!-- 从输入到编码器 - 调整连接点 -->
                        <line x1="217" y1="561" x2="217" y2="495" stroke="#555" stroke-width="1.5" />
                        <polygon points="217,495 212,505 222,505" fill="#555" />
                        <!-- 从输入到编码器左侧 - 调整连接点 -->
                        <line x1="180" y1="520" x2="180" y2="495" stroke="#555" stroke-width="1.5" />
                        <polygon points="180,495 175,505 185,505" fill="#555" />
                        <line x1="180" y1="520" x2="217" y2="520" stroke="#555" stroke-width="1.5" />
                        <!-- 从输入到编码器右侧 - 调整连接点 -->
                        <line x1="254" y1="520" x2="254" y2="495" stroke="#555" stroke-width="1.5" />
                        <polygon points="254,495 249,505 259,505" fill="#555" />
                        <line x1="254" y1="520" x2="217" y2="520" stroke="#555" stroke-width="1.5" />
                        <!-- 从输入到 add & norm2 -->
                        <line x1="110" y1="530" x2="217" y2="530" stroke="#555" stroke-width="1.5" />
                        <line x1="110" y1="430" x2="110" y2="530" stroke="#555" stroke-width="1.5" />
                        <line x1="110" y1="430" x2="130" y2="430" stroke="#555" stroke-width="1.5" />
                        <polygon points="130,430 120,435 120,425" fill="#555" />

                        <!-- 从multi-head attention到add & norm2 -->
                        <line x1="217" y1="455" x2="217" y2="445" stroke="#555" stroke-width="1.5" />

                        <!-- 从 add & norm2到feed forward -->
                        <line x1="217" y1="415" x2="217" y2="385" stroke="#555" stroke-width="1.5" />
                        <polygon points="217,385 212,395 222,395" fill="#555" />

                        <!-- 从 add & norm2到 add & norm1 -->
                        <line x1="110" y1="405" x2="217" y2="405" stroke="#555" stroke-width="1.5" />
                        <line x1="110" y1="405" x2="110" y2="335" stroke="#555" stroke-width="1.5" />
                        <line x1="110" y1="335" x2="130" y2="335" stroke="#555" stroke-width="1.5" />
                        <polygon points="130,335 120,340 120,330" fill="#555" />

                        <!-- 从feed forward到add & norm1 -->
                        <line x1="217" y1="360" x2="217" y2="350" stroke="#555" stroke-width="1.5" />
                        
                        <!-- 从输出嵌入到解码器 -->
                        <line x1="475" y1="562" x2="475" y2="495" stroke="#555" stroke-width="1.5" />
                        <polygon points="475,495 471,505 479,505" fill="#555" />
                        <!-- 从残差连接到 masked multi-head attention 左侧 -->
                        <line x1="440" y1="510" x2="475" y2="510" stroke="#555" stroke-width="1.5" />
                        <line x1="440" y1="510" x2="440" y2="495" stroke="#555" stroke-width="1.5" />
                        <polygon points="440,495 436,505 444,505" fill="#555" />
                        <!-- 从残差连接到 masked multi-head attention 右侧 -->
                        <line x1="475" y1="510" x2="510" y2="510" stroke="#555" stroke-width="1.5" />
                        <line x1="510" y1="510" x2="510" y2="495" stroke="#555" stroke-width="1.5" />
                        <polygon points="510,495 506,505 514,505" fill="#555" />
                        <!-- 从残差连接到 add & norm3 -->
                        <line x1="475" y1="525" x2="595" y2="525" stroke="#555" stroke-width="1.5" />
                        <line x1="595" y1="525" x2="595" y2="430" stroke="#555" stroke-width="1.5" />
                        <line x1="595" y1="430" x2="570" y2="430" stroke="#555" stroke-width="1.5" />
                        <polygon points="570,430 580,425 580,435" fill="#555" />

                        <!-- 从 masked multi-head attention到 add & norm3 -->
                        <line x1="475" y1="455" x2="475" y2="445" stroke="#555" stroke-width="1.5" />
                        
                        <!-- 从add & norm3到 multi-head attention -->
                        <line x1="475" y1="415" x2="475" y2="400" stroke="#555" stroke-width="1.5" />
                        <line x1="475" y1="400" x2="510" y2="400" stroke="#555" stroke-width="1.5" />
                        <line x1="510" y1="400" x2="510" y2="380" stroke="#555" stroke-width="1.5" />
                        <polygon points="510,380 506,390 514,390" fill="#555" />

                        <!-- 从 add & norm3到 add & norm2 -->
                        <line x1="475" y1="405" x2="595" y2="405" stroke="#555" stroke-width="1.5" />
                        <line x1="595" y1="405" x2="595" y2="325" stroke="#555" stroke-width="1.5" />
                        <line x1="595" y1="325" x2="570" y2="325" stroke="#555" stroke-width="1.5" />
                        <polygon points="570,325 580,320 580,330" fill="#555" />

                        <!-- 从 multi-head attention到 add & norm2 -->
                        <line x1="475" y1="340" x2="475" y2="350" stroke="#555" stroke-width="1.5" />

                        <!-- 从 add & norm2到 feed forward -->
                        <line x1="475" y1="310" x2="475" y2="285" stroke="#555" stroke-width="1.5" />
                        <polygon points="475,285 470,295 480,295" fill="#555" />

                        <!-- 从 add & norm2到 add & norm1 -->
                        <line x1="475" y1="300" x2="595" y2="300" stroke="#555" stroke-width="1.5" />
                        <line x1="595" y1="300" x2="595" y2="235" stroke="#555" stroke-width="1.5" />
                        <line x1="595" y1="235" x2="570" y2="235" stroke="#555" stroke-width="1.5" />
                        <polygon points="570,235 580,230 580,240" fill="#555" />

                        <!-- 从 feed forward 到 add & norm1 -->
                        <line x1="475" y1="260" x2="475" y2="250" stroke="#555" stroke-width="1.5" />

                        <!-- 从编码器到解码器的连接 - 调整连接点 -->
                        <line x1="217" y1="320" x2="217" y2="305" stroke="#555" stroke-width="1.5" />
                        <line x1="217" y1="305" x2="340" y2="305" stroke="#555" stroke-width="1.5" />
                        <line x1="340" y1="305" x2="340" y2="395" stroke="#555" stroke-width="1.5" />
                        <line x1="340" y1="395" x2="435" y2="395" stroke="#555" stroke-width="1.5" />
                        <line x1="435" y1="395" x2="435" y2="380" stroke="#555" stroke-width="1.5" />
                        <polygon points="435,380 430,390 440,390" fill="#555" />
                        <line x1="435" y1="395" x2="475" y2="395" stroke="#555" stroke-width="1.5" />
                        <line x1="475" y1="395" x2="475" y2="380" stroke="#555" stroke-width="1.5" />
                        <polygon points="475,380 470,390 480,390" fill="#555" />
                        
                        <!-- 从解码器到 linear -->
                        <line x1="475" y1="220" x2="475" y2="135" stroke="#555" stroke-width="1.5" />

                        <!-- 从 linear 到 softmax -->
                        <line x1="475" y1="110" x2="475" y2="100" stroke="#555" stroke-width="1.5" />
                        <polygon points="475,90 470,100 480,100" fill="#555" />

                        <!-- 从 softmax 到 输出 -->
                        <line x1="475" y1="65" x2="475" y2="55" stroke="#555" stroke-width="1.5" />
                        <polygon points="475,45 470,55 480,55" fill="#555" />
                        
                        <!-- 渐变定义 -->
                        <defs>
                            <linearGradient id="transformer-grad" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#8b5cf6" />
                                <stop offset="100%" stop-color="#3b82f6" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                <div class="text-sm text-neutral-600 dark:text-neutral-400 max-w-3xl mx-auto">
                    <p class="mb-2"><strong>Transformer架构特点：</strong></p>
                    <ul class="list-disc pl-5 space-y-1">
                        <li>编码器-解码器结构：左侧为编码器，右侧为解码器</li>
                        <li>多层堆叠：编码器和解码器各重复N次（原始论文中为6层）</li>
                        <li>自注意力机制：捕获序列内部的长距离依赖关系</li>
                        <li>多头注意力：同时关注序列的不同表征子空间</li>
                        <li>位置编码：为输入序列提供位置信息</li>
                        <li>残差连接：在每个子层周围添加残差连接，促进梯度流动</li>
                        <li>层归一化：稳定训练过程，加速收敛</li>
                        <li>掩码机制：在解码器中防止看到未来信息</li>
                    </ul>
                </div>
            </div>
            
            <!-- 数据流转交互动画示意图 -->
            <section id="data-flow-section" class="my-12">
                <h2 class="text-2xl font-bold text-neutral-800 dark:text-neutral-100 mb-6">
                    <i class="fas fa-stream text-purple-500 mr-2"></i>Transformer数据流转示意图
                </h2>

                <div class="flex justify-center mb-6 relative" id="data-flow-container">
                    <div class="step-indicator hidden" id="step-indicator">步骤 1/17</div>

                    <svg viewBox="0 0 700 800" class="w-full max-w-4xl" id="transformer-svg">
                        <!-- 背景 -->
                        <rect x="0" y="0" width="700" height="750" rx="10" fill="url(#transformer-grad)"
                            opacity="0.05" />
                        
                        <!-- 输出模块（绿色边框） -->
                        <g class="component-group">
                            <rect x="350" y="20" width="300" height="130" rx="5" stroke="#2e8b57" stroke-width="3"
                                fill="white" class="dark:white component" id="output-module" />
                            <text x="555" y="40" text-anchor="start" fill="#2e8b57" class="dark:fill-green-400"
                                font-size="18" font-weight="bold">4. Output</text>
                            <text x="470" y="40" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="14">Output Probabilities</text>
                        </g>
                        
                        <!-- Softmax -->
                        <g class="component-group">
                            <rect x="375" y="65" width="190" height="25" rx="3" stroke="#555" stroke-width="1"
                                fill="#D0E4CB" class="dark:#D0E4CB component" id="softmax" />
                            <text x="472" y="83" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Softmax</text>
                        </g>

                        <!-- Linear -->
                        <g class="component-group">
                            <rect x="375" y="110" width="190" height="25" rx="3" stroke="#555" stroke-width="1"
                                fill="#f0f0f0" class="dark:#f0f0f0 component" id="linear" />
                            <text x="472" y="126" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Linear</text>
                        </g>
                        
                        <!-- 解码器模块（蓝色边框） -->
                        <g class="component-group">
                            <rect x="350" y="175" width="300" height="365" rx="5" stroke="#4682b4" stroke-width="3"
                                fill="white" class="dark:white component" id="decoder-module" />
                            <text x="485" y="195" text-anchor="start" fill="#4682b4" class="dark:fill-blue-400"
                                font-size="18" font-weight="bold">3、Decoder block</text>
                            <text x="675" y="380" text-anchor="middle" fill="#4682b4" class="dark:fill-blue-400"
                                font-size="18">Nx</text>
                        </g>
                        
                        <!-- 解码器内部边框 -->
                        <rect x="365" y="210" width="240" height="325" rx="5" stroke="#555" stroke-width="1.5"
                            fill="#F3F3F3" />
                        
                        <!-- 解码器内部组件 -->
                        <!-- Add & Norm 1 -->
                        <g class="component-group">
                            <rect x="380" y="220" width="190" height="30" rx="3" stroke="#555" stroke-width="1"
                                fill="#ffffcc" class="dark:#ffffcc component" id="decoder-add-norm1" />
                            <text x="475" y="240" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Add
                                & Norm</text>
                        </g>
                        
                        <!-- Feed Forward -->
                        <g class="component-group">
                            <rect x="380" y="260" width="190" height="25" rx="3" stroke="#555" stroke-width="1"
                                fill="#add8e6" class="dark:#add8e6 component" id="decoder-ff" />
                            <text x="475" y="278" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Feed Forward</text>
                        </g>
                        
                        <!-- Add & Norm 2 -->
                        <g class="component-group">
                            <rect x="380" y="310" width="190" height="30" rx="3" stroke="#555" stroke-width="1"
                                fill="#ffffcc" class="dark:#ffffcc component" id="decoder-add-norm2" />
                            <text x="475" y="330" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Add
                                & Norm</text>
                        </g>
                        
                        <!-- Multi-Head Attention -->
                        <g class="component-group">
                            <rect x="380" y="350" width="190" height="30" rx="3" stroke="#555" stroke-width="1"
                                fill="#ffcc99" class="dark:#ffcc99 component" id="decoder-mha" />
                            <text x="475" y="370" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Multi-Head Attention</text>
                        </g>
                        
                        <!-- Add & Norm 3 -->
                        <g class="component-group">
                            <rect x="380" y="415" width="190" height="30" rx="3" stroke="#555" stroke-width="1"
                                fill="#ffffcc" class="dark:#ffffcc component" id="decoder-add-norm3" />
                            <text x="475" y="435" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Add
                                & Norm</text>
                        </g>
                        
                        <!-- Masked Multi-Head Attention -->
                        <g class="component-group">
                            <rect x="380" y="455" width="190" height="40" rx="3" stroke="#555" stroke-width="1"
                                fill="#ffcc99" class="dark:#ffcc99 component" id="decoder-masked-mha" />
                            <text x="475" y="475" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Masked Multi-Head</text>
                            <text x="475" y="490" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Attention</text>
                        </g>
                        
                        <!-- 编码器模块（红色边框） -->
                        <g class="component-group">
                            <rect x="85" y="260" width="240" height="280" rx="5" stroke="#cd5c5c" stroke-width="3"
                                fill="white" class="dark:white component" id="encoder-module" />
                            <text x="142" y="290" text-anchor="start" fill="#cd5c5c" class="dark:fill-red-400"
                                font-size="18" font-weight="bold">2、Encoder block</text>
                            <text x="60" y="410" text-anchor="middle" fill="#cd5c5c" class="dark:fill-red-400"
                                font-size="18">Nx</text>
                        </g>
                        
                        <!-- 编码器内部边框 -->
                        <rect x="100" y="310" width="210" height="225" rx="5" stroke="#555" stroke-width="1.5"
                            fill="#F3F3F3" />

                        <!-- 编码器内部组件 -->
                        <!-- Add & Norm 1 -->
                        <g class="component-group">
                            <rect x="130" y="320" width="170" height="30" rx="3" stroke="#555" stroke-width="1"
                                fill="#ffffcc" class="dark:#ffffcc component" id="encoder-add-norm1" />
                            <text x="215" y="340" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Add
                                & Norm</text>
                        </g>
                        
                        <!-- Feed Forward -->
                        <g class="component-group">
                            <rect x="130" y="360" width="170" height="25" rx="3" stroke="#555" stroke-width="1"
                                fill="#add8e6" class="dark:#add8e6 component" id="encoder-ff" />
                            <rect x="130" y="360" width="170" height="25" rx="3" stroke="#555" stroke-width="1"
                                fill="#add8e6" class="dark:#add8e6 component" id="encoder-ff" />
                            <text x="215" y="377" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Feed Forward</text>
                        
                        <!-- Add & Norm 2 -->
                            <rect x="130" y="415" width="170" height="30" rx="3" stroke="#555" stroke-width="1"
                                fill="#ffffcc" class="dark:#ffffcc component" id="encoder-add-norm2" />
                            <text x="215" y="435" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Add
                                & Norm</text>
                        
                        <!-- Multi-Head Attention -->
                            <rect x="130" y="455" width="170" height="40" rx="3" stroke="#555" stroke-width="1"
                                fill="#ffcc99" class="dark:#ffcc99 component" id="encoder-mha" />
                            <text x="215" y="472" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Multi-Head</text>
                            <text x="215" y="487" text-anchor="middle" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Attention</text>
                        
                        <!-- 输入模块（紫色边框） -->
                            <rect x="85" y="550" width="520" height="160" rx="5" stroke="#8b5cf6" stroke-width="3"
                                fill="white" class="dark:white component" id="input-module" />
                            <text x="110" y="670" text-anchor="start" fill="#8b5cf6" class="dark:fill-purple-400"
                                font-size="18" font-weight="bold">1、input</text>
                        
                        <!-- 位置编码 - 左侧 -->
                            <text x="100" y="565" text-anchor="start" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Positional</text>
                            <text x="100" y="580" text-anchor="start" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Encoding</text>
                        
                        <!-- 位置编码 - 右侧 -->
                            <text x="540" y="565" text-anchor="start" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Positional</text>
                            <text x="540" y="580" text-anchor="start" fill="#1e293b" class="dark:fill-black"
                                font-size="12">Encoding</text>
                        
                        <!-- 左侧旋转图标和连接 -->
                            <circle cx="180" cy="570" r="15" stroke="#555" stroke-width="1.5" fill="none"
                                class="component" id="input-pos-enc" />
                            <path d="M165,572 Q170,560 179,567 Q186,580 195,570" stroke="#555" stroke-width="1"
                                fill="none" />
                        <!-- 连接线到圆圈 -->
                            <line x1="195" y1="570" x2="217" y2="570" stroke="#555" stroke-width="1.5"
                                id="line-pe-to-res" />

                        <!-- 左侧残差连接 -->
                        <circle cx="217" cy="570" r="8" stroke="#64748b" stroke-width="1.5" fill="white"
                                class="dark:#64748b component" id="input-residual" />
                        <text x="217" y="576" text-anchor="middle" fill="#64748b" font-size="20">+</text>
                        
                        <!-- 右侧旋转图标和连接 -->
                            <circle cx="520" cy="570" r="15" stroke="#555" stroke-width="1.5" fill="none"
                                class="component" id="output-pos-enc" />
                            <path d="M505,570 Q513,560 520,570 Q527,580 535,570" stroke="#555" stroke-width="1.5"
                                fill="none" />
                        <!-- 连接线到圆圈 -->
                            <line x1="484" y1="570" x2="506" y2="570" stroke="#555" stroke-width="1.5"
                                id="line-pe-to-res-dec" />
                        
                        <!-- 右侧残差连接 -->
                        <circle cx="475" cy="570" r="8" stroke="#64748b" stroke-width="1.5" fill="white"
                                class="dark:#64748b component" id="output-residual" />
                        <text x="475" y="576" text-anchor="middle" fill="#64748b" font-size="20">+</text>
                        
                        <!-- 输入嵌入 -->
                            <rect x="160" y="605" width="115" height="30" rx="3" stroke="#555" stroke-width="1"
                                fill="#ffb6c1" class="dark:#ffb6c1 component" id="input-embedding" />
                            <text x="217" y="625" text-anchor="middle" fill="#1e293b" class="dark:#1e293b"
                                font-size="12">Input
                                Embedding</text>
                        
                        <!-- 从Input Embedding到圆圈的连接线 -->
                            <line x1="217" y1="605" x2="217" y2="578" stroke="#555" stroke-width="1.5"
                                id="line-emb-to-res" />
                        <polygon points="217,578 212,588 222,588" fill="#555" />

                        <!-- 输出嵌入 -->
                            <rect x="420" y="605" width="115" height="30" rx="3" stroke="#555" stroke-width="1"
                                fill="#ffb6c1" class="dark:#ffb6c1 component" id="output-embedding" />
                            <text x="478" y="625" text-anchor="middle" fill="#1e293b" class="dark:#1e293b"
                                font-size="12">Output
                                Embedding</text>
                        
                        <!-- 从Output Embedding到圆圈的连接线 -->
                            <line x1="475" y1="605" x2="475" y2="578" stroke="#555" stroke-width="1.5"
                                id="line-emb-to-res-dec" />
                        <polygon points="475,578 470,588 480,588" fill="#555" />

                        <!-- 输入与输出文本 -->
                            <text x="217" y="690" text-anchor="middle" fill="#1e293b" class="dark:fill-white"
                                font-size="12">Inputs</text>
                            <text x="475" y="690" text-anchor="middle" fill="#1e293b" class="dark:fill-white"
                                font-size="12">Outputs (shifted right)</text>
                        
                        <!-- 输入箭头 -->
                            <line x1="217" y1="675" x2="217" y2="635" stroke="#555" stroke-width="1.5"
                                id="line-in-to-emb" />
                        <polygon points="217,635 212,645 222,645" fill="#555" />
                        
                        <!-- 输出箭头 -->
                            <line x1="475" y1="675" x2="475" y2="635" stroke="#555" stroke-width="1.5"
                                id="line-out-to-emb" />
                        <polygon points="475,635 470,645 480,645" fill="#555" />
                        
                        <!-- 连接线 -->
                        <!-- 从输入到编码器 - 调整连接点 -->
                            <line x1="217" y1="561" x2="217" y2="495" stroke="#555" stroke-width="1.5"
                                id="line-res-to-enc" />
                        <polygon points="217,495 212,505 222,505" fill="#555" />

                        <!-- 从输入到编码器左侧 - 调整连接点 -->
                            <line x1="180" y1="520" x2="180" y2="495" stroke="#555" stroke-width="1.5"
                                id="line-left-res-to-enc" />
                        <polygon points="180,495 175,505 185,505" fill="#555" />
                            <line x1="180" y1="520" x2="217" y2="520" stroke="#555" stroke-width="1.5"
                                id="line-left-h-res" />

                        <!-- 从输入到编码器右侧 - 调整连接点 -->
                            <line x1="254" y1="520" x2="254" y2="495" stroke="#555" stroke-width="1.5"
                                id="line-right-res-to-enc" />
                        <polygon points="254,495 249,505 259,505" fill="#555" />
                            <line x1="254" y1="520" x2="217" y2="520" stroke="#555" stroke-width="1.5"
                                id="line-right-h-res" />

                            <!-- 编码器内残差连接 -->
                        <!-- 从输入到 add & norm2 -->
                            <line x1="110" y1="530" x2="217" y2="530" stroke="#555" stroke-width="1.5"
                                id="line-add-norm2-h" />
                            <line x1="110" y1="430" x2="110" y2="530" stroke="#555" stroke-width="1.5"
                                id="line-add-norm2-v" />
                            <line x1="110" y1="430" x2="130" y2="430" stroke="#555" stroke-width="1.5"
                                id="line-add-norm2-entry" />
                        <polygon points="130,430 120,435 120,425" fill="#555" />

                        <!-- 从multi-head attention到add & norm2 -->
                            <line x1="217" y1="455" x2="217" y2="445" stroke="#555" stroke-width="1.5"
                                id="line-mha-to-addnorm2" />

                        <!-- 从 add & norm2到feed forward -->
                            <line x1="217" y1="415" x2="217" y2="385" stroke="#555" stroke-width="1.5"
                                id="line-addnorm2-to-ff" />
                        <polygon points="217,385 212,395 222,395" fill="#555" />

                        <!-- 从 add & norm2到 add & norm1 -->
                            <line x1="110" y1="405" x2="217" y2="405" stroke="#555" stroke-width="1.5"
                                id="line-addnorm2-to-addnorm1-h" />
                            <line x1="110" y1="405" x2="110" y2="335" stroke="#555" stroke-width="1.5"
                                id="line-addnorm2-to-addnorm1-v" />
                            <line x1="110" y1="335" x2="130" y2="335" stroke="#555" stroke-width="1.5"
                                id="line-addnorm2-to-addnorm1-entry" />
                        <polygon points="130,335 120,340 120,330" fill="#555" />

                        <!-- 从feed forward到add & norm1 -->
                            <line x1="217" y1="360" x2="217" y2="350" stroke="#555" stroke-width="1.5"
                                id="line-ff-to-addnorm1" />
                        
                            <!-- 解码器内残差连接 -->
                        <!-- 从输出嵌入到解码器 -->
                            <line x1="475" y1="562" x2="475" y2="495" stroke="#555" stroke-width="1.5"
                                id="line-res-to-dec" />
                        <polygon points="475,495 471,505 479,505" fill="#555" />

                        <!-- 从残差连接到 masked multi-head attention 左侧 -->
                            <line x1="440" y1="510" x2="475" y2="510" stroke="#555" stroke-width="1.5"
                                id="line-left-dec-h" />
                            <line x1="440" y1="510" x2="440" y2="495" stroke="#555" stroke-width="1.5"
                                id="line-left-dec-v" />
                        <polygon points="440,495 436,505 444,505" fill="#555" />

                        <!-- 从残差连接到 masked multi-head attention 右侧 -->
                            <line x1="475" y1="510" x2="510" y2="510" stroke="#555" stroke-width="1.5"
                                id="line-right-dec-h" />
                            <line x1="510" y1="510" x2="510" y2="495" stroke="#555" stroke-width="1.5"
                                id="line-right-dec-v" />
                        <polygon points="510,495 506,505 514,505" fill="#555" />

                        <!-- 从残差连接到 add & norm3 -->
                            <line x1="475" y1="525" x2="595" y2="525" stroke="#555" stroke-width="1.5"
                                id="line-res-to-addnorm3-h" />
                            <line x1="595" y1="525" x2="595" y2="430" stroke="#555" stroke-width="1.5"
                                id="line-res-to-addnorm3-v" />
                            <line x1="595" y1="430" x2="570" y2="430" stroke="#555" stroke-width="1.5"
                                id="line-res-to-addnorm3-entry" />
                        <polygon points="570,430 580,425 580,435" fill="#555" />

                        <!-- 从 masked multi-head attention到 add & norm3 -->
                            <line x1="475" y1="455" x2="475" y2="445" stroke="#555" stroke-width="1.5"
                                id="line-masked-to-addnorm3" />
                        
                        <!-- 从add & norm3到 multi-head attention -->
                            <line x1="475" y1="415" x2="475" y2="400" stroke="#555" stroke-width="1.5"
                                id="line-addnorm3-to-mha-v" />
                            <line x1="475" y1="400" x2="510" y2="400" stroke="#555" stroke-width="1.5"
                                id="line-addnorm3-to-mha-h" />
                            <line x1="510" y1="400" x2="510" y2="380" stroke="#555" stroke-width="1.5"
                                id="line-addnorm3-to-mha-entry" />
                        <polygon points="510,380 506,390 514,390" fill="#555" />

                        <!-- 从 add & norm3到 add & norm2 -->
                            <line x1="475" y1="405" x2="595" y2="405" stroke="#555" stroke-width="1.5"
                                id="line-addnorm3-to-addnorm2-h" />
                            <line x1="595" y1="405" x2="595" y2="325" stroke="#555" stroke-width="1.5"
                                id="line-addnorm3-to-addnorm2-v" />
                            <line x1="595" y1="325" x2="570" y2="325" stroke="#555" stroke-width="1.5"
                                id="line-addnorm3-to-addnorm2-entry" />
                        <polygon points="570,325 580,320 580,330" fill="#555" />
                            <line x1="475" y1="400" x2="475" y2="380" stroke="#555" stroke-width="1.5"
                                id="line-addnorm3-to-mha-direct" />
                            <polygon points="475,380 470,390 480,390" fill="#555" />

                        <!-- 从 multi-head attention到 add & norm2 -->
                            <line x1="475" y1="350" x2="475" y2="340" stroke="#555" stroke-width="1.5"
                                id="line-mha-to-addnorm2-dec" />

                        <!-- 从 add & norm2到 feed forward -->
                            <line x1="475" y1="310" x2="475" y2="285" stroke="#555" stroke-width="1.5"
                                id="line-addnorm2-to-ff-dec" />
                        <polygon points="475,285 470,295 480,295" fill="#555" />

                        <!-- 从 add & norm2到 add & norm1 -->
                            <line x1="475" y1="300" x2="595" y2="300" stroke="#555" stroke-width="1.5"
                                id="line-addnorm2-to-addnorm1-h-dec" />
                            <line x1="595" y1="300" x2="595" y2="235" stroke="#555" stroke-width="1.5"
                                id="line-addnorm2-to-addnorm1-v-dec" />
                            <line x1="595" y1="235" x2="570" y2="235" stroke="#555" stroke-width="1.5"
                                id="line-addnorm2-to-addnorm1-entry-dec" />
                        <polygon points="570,235 580,230 580,240" fill="#555" />

                        <!-- 从 feed forward 到 add & norm1 -->
                            <line x1="475" y1="260" x2="475" y2="250" stroke="#555" stroke-width="1.5"
                                id="line-ff-to-addnorm1-dec" />

                        <!-- 从编码器到解码器的连接 - 调整连接点 -->
                            <line x1="217" y1="320" x2="217" y2="305" stroke="#555" stroke-width="1.5"
                                id="line-enc-out-v" />
                            <line x1="217" y1="305" x2="340" y2="305" stroke="#555" stroke-width="1.5"
                                id="line-enc-to-dec-h" />
                            <line x1="340" y1="305" x2="340" y2="395" stroke="#555" stroke-width="1.5"
                                id="line-enc-to-dec-v" />
                            <line x1="340" y1="395" x2="435" y2="395" stroke="#555" stroke-width="1.5"
                                id="line-enc-to-dec-entry-h" />
                            <line x1="435" y1="395" x2="435" y2="380" stroke="#555" stroke-width="1.5"
                                id="line-enc-to-dec-entry-v" />
                        <polygon points="435,380 430,390 440,390" fill="#555" />
                        
                        <!-- 从解码器到 linear -->
                            <line x1="475" y1="220" x2="475" y2="135" stroke="#555" stroke-width="1.5"
                                id="line-dec-to-linear" />

                        <!-- 从 linear 到 softmax -->
                            <line x1="475" y1="110" x2="475" y2="90" stroke="#555" stroke-width="1.5"
                                id="line-linear-to-softmax" />
                        <polygon points="475,90 470,100 480,100" fill="#555" />

                        <!-- 从 softmax 到 输出 -->
                            <line x1="475" y1="65" x2="475" y2="45" stroke="#555" stroke-width="1.5"
                                id="line-softmax-to-output" />
                        <polygon points="475,45 470,55 480,55" fill="#555" />

                            <!-- 编码器残差连接动画元素 -->
                            <g id="encoder-residual-animations">
                                <!-- Add & Norm 2 残差 -->
                                <circle id="encoder-residual-1" cx="110" cy="430" r="0" class="residual-circle" />
                                <!-- Add & Norm 1 残差 -->
                                <circle id="encoder-residual-2" cx="110" cy="335" r="0" class="residual-circle" />
                            </g>

                            <!-- 解码器残差连接动画元素 -->
                            <g id="decoder-residual-animations">
                                <!-- Add & Norm 3 残差 -->
                                <circle id="decoder-residual-1" cx="595" cy="430" r="0" class="residual-circle" />
                                <!-- Add & Norm 2 残差 -->
                                <circle id="decoder-residual-2" cx="595" cy="325" r="0" class="residual-circle" />
                                <!-- Add & Norm 1 残差 -->
                                <circle id="decoder-residual-3" cx="595" cy="235" r="0" class="residual-circle" />
                            </g>
                        
                        <!-- 渐变定义 -->
                        <defs>
                            <linearGradient id="transformer-grad" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" stop-color="#8b5cf6" />
                                <stop offset="100%" stop-color="#3b82f6" />
                            </linearGradient>
                        </defs>
                    </svg>

                    <!-- 注释框用于显示组件解释 -->
                    <div id="annotation" class="annotation-box"></div>
                    
                    <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-4">
                        <button id="start-animation"
                            class="px-4 py-2 bg-primary-500 text-white rounded hover:bg-primary-600 transition">
                            <i class="fas fa-play mr-2"></i>启动数据流
                        </button>
                        <button id="reset-animation"
                            class="px-4 py-2 bg-neutral-200 dark:bg-neutral-700 text-neutral-700 dark:text-neutral-200 rounded hover:bg-neutral-300 dark:hover:bg-neutral-600 transition">
                            <i class="fas fa-redo mr-2"></i>重置
                        </button>
                        <div class="flex items-center">
                            <label class="inline-flex items-center mr-2 cursor-pointer">
                                <input type="checkbox" id="show-details"
                                    class="form-checkbox h-4 w-4 text-primary-500 rounded border-neutral-300 dark:border-neutral-600 focus:ring-primary-500 dark:focus:ring-primary-400">
                                <span class="ml-2 text-sm text-neutral-700 dark:text-neutral-300">显示详细注释</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- 控制面板 -->
                <div class="control-panel" id="control-panel">
                    <button id="pause-resume"
                        class="px-4 py-2 bg-neutral-200 dark:bg-neutral-700 text-neutral-700 dark:text-neutral-200 rounded hover:bg-neutral-300 dark:hover:bg-neutral-600 transition hidden">
                        <i class="fas fa-pause mr-2"></i>暂停
                    </button>
                    <button id="step-backward"
                        class="px-4 py-2 bg-neutral-200 dark:bg-neutral-700 text-neutral-700 dark:text-neutral-200 rounded hover:bg-neutral-300 dark:hover:bg-neutral-600 transition hidden">
                        <i class="fas fa-step-backward mr-2"></i>上一步
                    </button>
                    <button id="step-forward"
                        class="px-4 py-2 bg-neutral-200 dark:bg-neutral-700 text-neutral-700 dark:text-neutral-200 rounded hover:bg-neutral-300 dark:hover:bg-neutral-600 transition hidden">
                        <i class="fas fa-step-forward mr-2"></i>下一步
                    </button>
                    <div class="speed-control">
                        <label for="animation-speed">动画速度:</label>
                        <input type="range" id="animation-speed" class="speed-slider" min="0.5" max="2" step="0.1"
                            value="1">
                        <span id="speed-value">1x</span>
                    </div>
                </div>

                <div class="text-sm text-neutral-600 dark:text-neutral-400 max-w-3xl mx-auto mt-4"
                    id="flow-description">
                    <p class="mb-2"><strong>数据流转过程：</strong></p>
                    <div id="flow-details" class="pl-5">
                        <p class="leading-relaxed mb-2">点击"启动数据流"按钮来观察数据在Transformer模型中的流转过程。</p>
                    </div>
                </div>
                
                <!-- 自注意力可视化面板 -->
                <div id="attention-visualization"
                    class="bg-white dark:bg-neutral-800 rounded-lg shadow-sm border border-neutral-100 dark:border-neutral-700 p-4 mt-4 hidden">
                    <h4 class="text-lg font-semibold text-neutral-800 dark:text-neutral-100 mb-3">
                        <i class="fas fa-brain text-primary-500 mr-2"></i>自注意力机制可视化
                    </h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="attention-matrix-container">
                            <h5 class="text-sm font-medium mb-2 text-neutral-700 dark:text-neutral-300">注意力权重矩阵</h5>
                            <div id="attention-heatmap"
                                class="h-48 bg-neutral-50 dark:bg-neutral-900 rounded overflow-hidden">
                            </div>
                        </div>
                        <div>
                            <h5 class="text-sm font-medium mb-2 text-neutral-700 dark:text-neutral-300">权重解释</h5>
                            <div id="attention-explanation" class="text-sm text-neutral-600 dark:text-neutral-400">
                                <p>自注意力机制允许模型关注输入序列中的不同位置，为每个位置分配不同的权重。在可视化中，颜色越深表示权重越高。</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
    </main>
    
    <!-- 页脚 -->
    <footer class="py-8 border-t border-light bg-neutral-50/30 dark:bg-neutral-900/30">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <div class="flex items-center mb-2">
                        <div class="w-6 h-6 bg-gradient-primary rounded-md flex items-center justify-center mr-2">
                            <i class="fas fa-brain text-white text-xs"></i>
                        </div>
                        <span class="text-neutral-700 dark:text-neutral-300 font-medium">大模型全栈平台</span>
                    </div>
                    <p class="text-neutral-500 dark:text-neutral-400 text-sm">
                        探索大语言模型的原理与应用，从理论到实践的全栈学习平台
                    </p>
                </div>

                <div class="grid grid-cols-2 gap-8 md:gap-16">
                    <div>
                        <h4 class="text-sm font-semibold mb-3 text-neutral-800 dark:text-neutral-200">学习资源</h4>
                        <ul class="space-y-2">
                            <li>
                                <a href="../../models/theory/index.html"
                                    class="text-sm text-neutral-600 dark:text-neutral-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">模型原理</a>
                            </li>
                            <li>
                                <a href="../../applications/index.html"
                                    class="text-sm text-neutral-600 dark:text-neutral-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">应用开发</a>
                            </li>
                            <li>
                                <a href="../../components/index.html"
                                    class="text-sm text-neutral-600 dark:text-neutral-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">核心组件</a>
                            </li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="text-sm font-semibold mb-3 text-neutral-800 dark:text-neutral-200">热门主题</h4>
                        <ul class="space-y-2">
                            <li>
                                <a href="../../applications/fine-tuning.html"
                                    class="text-sm text-neutral-600 dark:text-neutral-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">模型微调</a>
                            </li>
                            <li>
                                <a href="../../applications/agent.html"
                                    class="text-sm text-neutral-600 dark:text-neutral-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">Agent
                                    开发</a>
                            </li>
                            <li>
                                <a href="../../applications/rag.html"
                                    class="text-sm text-neutral-600 dark:text-neutral-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">RAG
                                    系统</a>
                            </li>
                            <li>
                                <a href="../../about/index.html"
                                    class="text-sm text-neutral-600 dark:text-neutral-400 hover:text-primary-600 dark:hover:text-primary-400 transition-colors">关于我们</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="mt-8 pt-6 border-t border-light flex flex-col md:flex-row justify-between items-center">
                <p class="text-sm text-neutral-500 dark:text-neutral-400 mb-4 md:mb-0">
                    &copy; 2025-2025 大模型全栈平台. 保留所有权利.
                </p>
                <div class="flex space-x-4">
                    <a href="#"
                        class="text-neutral-400 hover:text-primary-500 dark:hover:text-primary-400 transition-colors">
                        <i class="fas fa-rss"></i>
                    </a>
                    <a href="#"
                        class="text-neutral-400 hover:text-primary-500 dark:hover:text-primary-400 transition-colors">
                        <i class="fas fa-book"></i>
                    </a>
                    <a href="#"
                        class="text-neutral-400 hover:text-primary-500 dark:hover:text-primary-400 transition-colors">
                        <i class="fas fa-graduation-cap"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- 返回顶部按钮 -->
    <button id="back-to-top"
        class="fixed bottom-6 right-6 p-2 rounded-full bg-primary-500 text-white shadow-lg opacity-0 invisible transition-all duration-300 hover:bg-primary-600 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:focus:ring-offset-neutral-900">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Preline UI 初始化 -->
    <script src="../../common/js/preline.min.js"></script>
    
    <!-- 导航和主题切换脚本 -->
    <script src="../../common/js/navigation.js"></script>
    <script src="../../common/js/theme.js"></script>

    <!-- 链接验证器 -->
    <script src="../../common/js/linkValidator.js"></script>

    <!-- 数据流转交互动画示意图 -->
    <script src="../../common/js/models/transformer/transformer_animate.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 初始化主题管理器
            const themeManager = ThemeManager.getInstance();

            // 初始化导航功能
            const navigation = Navigation.getInstance();
            
            // 控制返回顶部按钮的显示
            const backToTopBtn = document.getElementById('back-to-top');
            
            window.addEventListener('scroll', () => {
                if (window.pageYOffset > 300) {
                    backToTopBtn.classList.remove('opacity-0', 'invisible');
                    backToTopBtn.classList.add('opacity-100', 'visible');
                } else {
                    backToTopBtn.classList.add('opacity-0', 'invisible');
                    backToTopBtn.classList.remove('opacity-100', 'visible');
                }
            });
            
            // 点击返回顶部
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
        });                    
    </script>
</body>

</html> 